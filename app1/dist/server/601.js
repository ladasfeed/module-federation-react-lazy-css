"use strict";exports.id=601,exports.ids=[601],exports.modules={601:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var r=n(2244),a=n.n(r),l=n(3973),o=n(9651);const s=e=>{const t=(0,r.useContext)(e.context);return"undefined"==typeof window&&t.collectChunk({type:e.type,name:e.name,mf:e.mf}),e.children},c=(0,r.createContext)({collectChunk:()=>{}}),i=a().lazy((()=>n.e(104).then(n.t.bind(n,2104,23))));var d=({collectChunk:e=(()=>{})})=>{const[t,n]=a().useState(""),[o,d]=a().useState(!0);return(0,r.useEffect)((()=>{alert("hydrated app1")}),[]),a().createElement(c.Provider,{value:{collectChunk:e}},a().createElement("div",{style:{padding:"1rem",borderRadius:"0.25rem",border:"4px dashed #fc451e"}},a().createElement(l.Helmet,null,a().createElement("title",null,"SSR MF Example")),a().createElement("div",{style:{padding:"1rem"}},a().createElement("h1",null,"Module Federation Example: React 18 Code Splitting"),a().createElement("h2",null,"This is the App 1 application.")),a().createElement("div",{style:{padding:"1rem"}},a().createElement("h3",null,"Type something into this input"),a().createElement("input",{type:"text",value:t,onChange:e=>n(e.target.value),placeholder:"Luke, I am your father..."})),a().createElement("div",{style:{padding:"1rem"}},a().createElement("button",{onClick:()=>d((e=>!e))},"Toggle micro frontend")),a().createElement("div",{style:{padding:"1rem"}},o&&a().createElement(a().Suspense,{fallback:a().createElement("h1",null,"Loading....")},a().createElement(s,{mf:"app2",type:"federation",context:c,name:"StringFormatter"},a().createElement(i,{content:t,Context:c}))))))},u=n(2781),m=n(4453);const h={app2:"http://localhost:3001/static"},p=e=>Object.entries(e.data.federatedModules[0].exposes).reduce(((e,[t,n])=>{var r;return e[t.replace("./","")]=(r=n[0],Object.entries(r).reduce(((e,[t,n])=>(e.push(...n.filter((e=>e.includes(".css")))),e)),[])),e}),{}),f=()=>{let e=[],t=[];const n={};return{collectChunk:n=>{e.push(n),"federation"==n.type&&t.push(n.mf)},finish:async()=>{try{await(({requiredRemotes:e,statsDataCache:t})=>{const n=e.map((e=>(async(e,t)=>{const[n,r]=await Promise.all([m.Z.get(`${h[e]}/federation-stats.json`),m.Z.get(`${h[e]}/stats.json`)]);var a;t[e]={federationStats:p(n),lazyStats:(a=r,Object.entries(a.data.assetsByChunkName).reduce(((e,[t,n])=>(e[t]=n.filter((e=>e.includes(".css"))),e)),{}))}})(e,t)));return Promise.all(n)})({requiredRemotes:t,statsDataCache:n});const r=((e,t)=>{const n=[];return t.forEach((t=>{const r="federation"==t.type?"federationStats":"lazyStats",a=e[t.mf][r][t.name].map((e=>`${h[t.mf]}/${e}`));n.push(...a)})),n})(n,e);return r.map((e=>`<link rel="stylesheet" href="${e}">`)).join("")}catch(e){return console.error(e,"Something went wrong with chunk collector..."),""}}}};var y=async(e,t,n)=>{const r=l.Helmet.renderStatic();let s=!1;const c=new u.Writable({write(e,n,r){t.write(e,n,r)},final(e){e()}}),i=f(),m=(0,o.$f)(a().createElement(d,{collectChunk:i.collectChunk}),{async onAllReady(){const e=await i.finish();t.statusCode=s?500:200,t.setHeader("Content-type","text/html"),t.write(`\n        <html ${r.htmlAttributes.toString()}>\n        <head>\n          ${e}\n          ${r.title.toString()}\n          ${r.meta.toString()}\n          ${r.link.toString()}\n        </head>\n        <body><div id="root">`),m.pipe(c),t.write('</div><script async data-chunk="main" src="http://localhost:3000/static/main.js"><\/script></body></html>'),t.end()},onShellError(){t.statusCode=500,t.send("<h1>An error occurred</h1>")},onError(e){s=!0,console.error(e)}})}}};